<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Googol Search</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div class="container">

    <div th:if="${message}" th:class="'alert ' + (${msgType} == 'success' ? 'alert-success' : 'alert-error')" th:text="${message}"></div>

    <div class="header">
        <div class="tools-row">
            <div class="tool-box">
                <span class="tool-title">Adicionar URL</span>
                <form action="/index" method="post" class="input-group">
                    <input type="url" name="url" placeholder="http://..." required>
                    <button type="submit" class="btn btn-primary">Add</button>
                </form>
            </div>

            <div class="tool-box">
                <span class="tool-title">Links de Entrada</span>
                <form action="/links" method="get" class="input-group">
                    <input type="url" name="url" placeholder="http://..." required>
                    <button type="submit" class="btn btn-secondary">Ver</button>
                </form>
            </div>

            <div class="stats-box">
                <div class="stats-header-bar">
                    <span class="tool-title" style="margin:0;">Googol System Stats</span>
                    <span id="status-dot" class="status-dot" title="Estado da Conexão"></span>
                </div>
                <div id="stats-content" class="stats-content">
                    A conectar ao servidor de estatísticas...
                </div>
            </div>
        </div>
    </div>

    <div class="search-section">
        <a href="/" class="logo">
            <span>G</span><span>o</span><span>o</span><span>g</span><span>o</span><span>l</span>
        </a>
        <form action="/" method="get" class="search-form">
            <input type="text" name="q" class="search-input" th:value="${query}" placeholder="Pesquise no Googol ou escreva um URL">
        </form>
    </div>

    <div th:if="${aiSummary}" style="margin-bottom: 30px; background: linear-gradient(135deg, #f0f7ff 0%, #ffffff 100%); padding: 20px; border-radius: 12px; border: 1px solid #dbe7f5; box-shadow: 0 2px 5px rgba(0,0,0,0.02);">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <strong style="color: #1a0dab; font-size: 15px;">✨ Googol AI Overview</strong>
        </div>
        <p th:text="${aiSummary}" style="margin: 0; color: #3c4043; line-height: 1.6; font-size: 14px;"></p>
    </div>

    <div th:if="${results != null}">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <div class="result-stats" th:text="'Resultados: ' + ${totalResults}"></div>
            <form action="/hacker-news/index" method="post">
                <input type="hidden" name="query" th:value="${query}">
                <button type="submit" class="btn" style="background-color: #ff6600; color: white; border-radius: 12px; font-size: 12px; padding: 6px 12px;">
                    Y Hacker News
                </button>
            </form>
        </div>

        <div th:if="${results.isEmpty()}" style="text-align:center; margin-top:50px; color: #5f6368;">
            <p>Nenhum resultado encontrado para <strong><span th:text="${query}"></span></strong>.</p>
        </div>

        <div th:each="entry : ${results}" class="result-card">
            <span class="result-url" th:text="${entry.key}">http://url.com</span>
            <a th:href="${entry.key}" class="result-title" th:text="${entry.value.title}">Sem Título</a>
            <div class="result-snippet" th:text="${entry.value.citation}">Descrição...</div>
            <a th:href="@{/links(url=${entry.key})}" class="btn-link">Ver links de entrada</a>
        </div>

        <div class="pagination" th:if="${totalPages > 1}">
            <a th:if="${currentPage > 1}" th:href="@{/(q=${query}, page=${currentPage - 1})}" class="page-btn">Anterior</a>
            <span style="font-size:13px; color:#5f6368; align-self:center;" th:text="'Pág ' + ${currentPage}"></span>
            <a th:if="${currentPage < totalPages}" th:href="@{/(q=${query}, page=${currentPage + 1})}" class="page-btn">Seguinte</a>
        </div>
    </div>
</div>

<script type="text/javascript" th:src="@{/js/dashboard.js}"></script>

</body>
</html>